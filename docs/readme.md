# 지하철 노선도 관리 1, 2단계

## 기능 요구 사항

### 1. 역 관리 API

- [x] 역 생성
- [x] 중복 이름 역 생성 불가
- [x] 역 목록 조회
- [x] 역 단일 조회
- [x] 역 삭제

### 2. 노선 관리 API

- [x] 노선 생성
    - [x] 상행역,하행역,거리 필요
    - [x] 구간 정보도 함께 등록
- [x] 노선 목록 조회
- [x] 노선 단일 조회
    - [ ] 상행종점에서 하행종점까지 역 목록 함께 반환
    - [x] 역 목록 정렬
- [x] 노선 수정
- [x] 노선 삭제

### 3. 구간 관리 API

- [ ] 노선에 구간 추가
    - [ ] 상/하행역,거리 필요
    - [ ] 상행/하행역 중 **하나만** 노선에 등록되어 있어야 함
    - [ ] 상/하행역 중 하나가 노선의 종점이라면 나머지 하나가 종점이 됨
    - 중간 추가
        - [ ] 재배치: 기존 A2C => A1B 추가 => A1B - B1C
        - [ ] **중간에 추가시** 기존의 구간보다 **거리가 작아야** 함
    - 예외 처리
        - [ ] 상행/하행역 모두 노선에 존재O
        - [ ] 상행/하행역 모두 노선에 존재X
        - [ ] 중간에 추가시 새 구간의 길이가 기존 구간길이 이상(<=)
- [ ] 구간 삭제
    - [ ] 종점 제거시 그 다음역이 종점이 됨
    - 중간 제거
        - [ ] 재배치: 기존 A1B - B1C => B 제거 -> A2C
    - 예외 처리
        - [ ] 삭제하려는 역이 노선에 존재X
        - [ ] 노선에 구간이 하나일 때

### 예외 처리
- [x] 서비스에 종속적인 커스텀 예외 정의
- [x] Dao에서 발생한 DB예외를 서비스레이어에서 처리
- [x] 리소스 생성 요청시 요청데이터를 바로 리턴하지 말고 DB에서 다시 쿼리하도록 변경

### 설계
- [ ] 서비스에서 다른 서비스 호출하도록 변경
    - 상위 서비스는 하위 서비스만 참조
    - 하위 서비스는 DAO와 1대1 매핑
- [ ] 서비스계층이 도메인을 보호해야하나? (서비스에서 DTO를 반환?)